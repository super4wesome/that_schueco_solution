[{"id":"fddeb24b.a6ed68","type":"function","z":"6d48f851.6b2f4","name":"filter","func":"var globalContext = this.context.global;\nvar window_state = globalContext.get(\"window_state\")\nif (globalContext.get(\"auto_control\") == \"On\" && msg.payload[\"value_name\"] == \"room2nd_heater_state\") {\n var return_obj = {}\n if (msg.payload[\"value\"] == \"On\" && window_state == \"Closed\") {\n  return_obj[\"payload\"] = \"Yayy. You only turn on the heating when your window is closed. Good human, I like you.\"\n  return return_obj\n } else if (msg.payload[\"value\"] == \"On\" && window_state != \"Closed\") {\n  return_obj[\"payload\"] = \"What the fuck, close your window when heating. Poolar bears are dying because of you. Shame, shame, shame on you.\"\n  globalContext.set(\"window_state_cmd\", \"Closed\")\n  return return_obj\n }\n}","outputs":1,"noerr":0,"x":139,"y":1020,"wires":[["944fa53.c244bd8","766ca449.b49acc"]]}]
